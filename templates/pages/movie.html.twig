{% extends 'base.html.twig' %}
{% block middle %}
    <br>
    <div style="display: flex; margin-left: 10%; margin-right: 10%">
        <img src="{{ movie.img }}">
        <article style="padding-left:15px">
            <h1 style="font-size:60px">{{movie.title}}</h1>
	        
            <div id="userRating">
                {% if app.user %}
                    {% include 'pages/rating.html.twig' %}
                {% endif %}
            </div>
            <div class="d-flex justify-content-end">
                {% if rate == "Movie without a rate" %}
                    <strong> {{ rate }} </strong>
                {% else %}
                    <label class="active">
                    <i class="active fa fa-star fa-3x" aria-hidden="true" id="ratemajor"><strong>{{ rate }}/10</strong></i>
                {% endif %}
            </div>
            <hr>
            <br>
            {% for genre in movie.genres %}
                 <a href="http://127.0.0.1:8000/Genre/{{genre.id}}"><strong style="font-size:30px">{{ genre.nameGenre }}, </strong></a>
            {% endfor %}
            <br>         
            <p style="font-size:30px">Duration : <strong style="font-size:30px">{{ movie.duration }} min</strong></p>
            <p style="font-size:30px">Created at : <strong style="font-size:30px">{{ movie.createdAt }}</strong></p> 
            <p style="font-size:30px">Made by : <strong style="font-size:30px">{{ movie.director.nameDirector }}</strong></p> 
            <p style="font-size:30px"> Actors : 
            {% for actor in movie.actors %}
                 <a href="http://127.0.0.1:8000/Actor/{{actor.id}}"><strong style="font-size:30px">{{ actor.nameActor }},</strong></a>
            {% endfor %}
            </p>
            <p style="font-size:30px"><strong style="font-size:30px">{{movie.overview}}</strong></p>
        </article>
    </div>       


  
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {% if app.user %}
        <script>
                function average(){
                    $.post(
                        "/AverageRate/" +{{movie.id}},
                        function(data){
                            console.log(data)
                        }
                    )
                }
                $(".fa-star").click(function(){

                    var note = $(this).siblings(".star").val();
                    $.post(
                        "/Rate/"+note+"/"+{{ app.user.id }}+"/"+{{ movie.id }},
                        function(data){
                            $("#userRating").html(data);
                            average()
                        }
                    )
                })

        </script>
    {% endif %}
{% endblock %} 